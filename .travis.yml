matrix:
  include:
    - language: perl
      perl: "5.16"
    - language: perl
      perl: "5.14"
    - language: perl
      perl: "5.12"
    - language: perl
      perl: "5.10"
    - language: perl
      perl: "5.8"

services:
  - memcached

addons:
  apt_packages:
    # For installing DB_File.
    - libdb-dev
    # For Imager manipulating GIF.
    - libgif-dev
    # For dynamic publishing.
    - php5
    - php5-cli
    - php5-mysql
    - php5-gd
    - php5-memcache

before_script:
  - mysql -e "create database mt_test;"
  - mysql -uroot -e "grant all privileges on mt_test.* to mt@localhost;"

  # Some tests need mt-config.cgi.
  - cp ./t/mysql-test.cfg ./mt-config.cgi

  # Skip failed tests.
  - rm t/90-podcoverage.t

  # Skip not MTOS tests.
  - rm t/110-commercial-permission-cms.t
  - rm t/110-community-pemission.t
  - rm t/110-enterprise-permission.t
  - rm t/33-ddl-postgresql.t
  - rm t/33-postgresql.t
  - rm t/36-ddl-oracle.t
  - rm t/36-oracle.t
  - rm t/37-ddl-mssqlserver.t
  - rm t/37-mssqlserver.t
  - rm t/44-spider.t
  - rm t/46-i18n-en.t
  - rm t/47-i18n-ja.t
  - rm t/51-objectsync.t
  - rm t/52-ldap.t
  - rm t/53-grouptsync.t
  - rm t/54-usersgroupsroles.t

script:
  - PERL_HASH_SEED=0 prove t plugins/*/t

